#!/usr/sbin/nft -f

flush ruleset

table inet filter {
  chain input {
    type filter hook input priority filter; policy drop;

    # Drop invalid packets
    ct state invalid drop

    # Accept established and related connections
    ct state { established, related } accept

    # Accept all traffic from loopback
    iif "lo" accept

    # Allow ICMP
    ip protocol icmp accept
    ip6 nexthdr icmpv6 accept

    # Allow SSH
    tcp dport ssh accept

    # Allow HTTP and HTTPS
    tcp dport https accept
  }

  chain forward { type filter hook forward priority filter; policy drop; }
  chain output { type filter hook output priority filter; policy accept; }
}
